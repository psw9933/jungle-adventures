{"version":3,"sources":["bossContol.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\game","sourcesContent":["import { gameProtocol } from \"./gameProtocol\"\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class bossContol extends cc.Component {\r\n\r\n    /**角色运动类型 */\r\n    @property\r\n    _actionType = gameProtocol.bossControl.actionType.patrol;\r\n\r\n    private spine: sp.Skeleton = null;\r\n    /**人物朝向 true为右方false为左边 */\r\n    public Orientation: boolean = false;\r\n\r\n    //动画节点缩放 用来控制面向\r\n    private playerScale: any = null;\r\n\r\n    private patrolArea: number = 0\r\n\r\n    onLoad() {\r\n        this.playerScale = 0.6;\r\n        this.patrolArea = gameProtocol.bossControl.patrolArea;\r\n        this.initEvent()\r\n        this.spine = this.node.getComponent(sp.Skeleton);\r\n        this.node.scale = this.playerScale;\r\n\r\n        //this.patrolStatus()\r\n\r\n    }\r\n\r\n    private initEvent() {\r\n        //cc.systemEvent.on(gameProtocol.event.playerShooting, this.Shooting, this);\r\n    }\r\n    private clearEvent() {\r\n        //cc.systemEvent.off(gameProtocol.event.playerShooting, this.Shooting, this);\r\n    }\r\n\r\n    // update (dt) {}\r\n    onMuzzlePos(){\r\n        let size=this.node.getContentSize();\r\n        let x=(size.width/2)*this.playerScale;\r\n        let y=(size.height/2)*this.playerScale;\r\n\r\n        return new cc.Vec2(x,y)\r\n    }\r\n    private isPatrol: boolean = false\r\n    patrolStatus() {\r\n        if (this.isPatrol) return;\r\n        this.isPatrol = true;\r\n\r\n        this.spine.setAnimation(1, 'move', true)\r\n        let _pos = this.node.getPosition();\r\n\r\n        let left_pos = new cc.Vec2(_pos.x - this.patrolArea, _pos.y);\r\n        let right_pos = new cc.Vec2(_pos.x + this.patrolArea, _pos.y);\r\n\r\n        let action1 = cc.callFunc(() => {\r\n            this.node.scaleX = this.playerScale\r\n        })\r\n        let action2 = cc.callFunc(() => {\r\n            this.node.scaleX = -this.playerScale\r\n        })\r\n        this.node.runAction(cc.sequence(action1, cc.moveTo(2, left_pos), action2, cc.moveTo(2, right_pos)).repeatForever());\r\n    }\r\n\r\n    private isAttack: boolean = false\r\n    attackStatus() {\r\n        if (this.isAttack) return;\r\n        this.isAttack = true;\r\n\r\n        this.node.stopAllActions();\r\n        this.spine.setAnimation(1, 'attack', true)\r\n        //cc.log('attackStatus');\r\n        cc.systemEvent.emit(gameProtocol.event.bossShooting, this);\r\n    }\r\n\r\n    update(dt) {\r\n        switch (this._actionType) {\r\n            case gameProtocol.bossControl.actionType.patrol:\r\n                this.patrolStatus()\r\n                break;\r\n            case gameProtocol.bossControl.actionType.attack:\r\n                this.attackStatus()\r\n                break;\r\n        }\r\n    }\r\n}\r\n"]}